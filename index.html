<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ–°å®¢è¼”åŠ©</title>
  <style>
    :root{
      --bg1:#f8fafc; --bg2:#eef2f7; --card:#ffffff; --text:#0f172a;
      --muted:#64748b; --border:#e2e8f0; --border2:#cbd5e1;
      --accent:#22c55e; --accentH:#16a34a;
      --danger:#dc2626; --dangerH:#b91c1c;
      --tabBg:#e2e8f0; --tabBorder:#cbd5e1; --tabText:#0f172a;
      --tabActBg:#ecfdf5; --tabActBorder:#22c55e; --tabActText:#065f46;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, 'PingFang TC', 'Microsoft JhengHei', Arial, sans-serif;
      color:var(--text);
      background: linear-gradient(180deg, var(--bg1), var(--bg2));
      font-size:16px;
    }
    .container{max-width: 980px; margin: 0 auto; padding:24px;}
    .header{
      background:rgba(255,255,255,.9); backdrop-filter:saturate(180%) blur(6px);
      border:1px solid var(--border); border-radius:24px; padding:16px 20px; display:flex; align-items:center; justify-content:space-between; gap:16px;
      box-shadow: 0 1px 2px rgba(0,0,0,.04);
    }
    h1{font-size:22px; margin:0; font-weight:800}
    .btn{
      appearance:none; border:1px solid var(--border2); background:#fff; color:#0f172a;
      padding:12px 16px; border-radius:14px; font-size:15px; font-weight:800; cursor:pointer; transition:.15s ease;
    }
    .btn:hover{background:#f8fafc}
    .btn-green{ background:#16a34a; color:#fff; border-color:transparent; box-shadow:0 8px 22px rgba(22,163,74,.18) }
    .btn-danger{ background:#fef2f2; color:#dc2626; border-color:#fecaca }
    .btn-danger:hover{ background:#fee2e2 }
    .btn-primary{ background:var(--accent); color:#fff; border-color:transparent }
    .btn-next{ font-size:19px; padding:18px 26px; border-radius:18px }
    .btn-lg{ font-size:17px; padding:16px 22px }
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .grid{display:grid; gap:20px}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:24px; padding:22px;
      box-shadow: 0 2px 6px rgba(15,23,42,.04);
    }
    .sectionTitle{font-size:21px; font-weight:900; color:#065f46; letter-spacing:.04em; margin-bottom:8px}
    .choiceWrap{border:2px dashed var(--border2); background:#fff7ed; border-radius:16px; padding:14px}
    .choices{display:grid; grid-template-columns:1fr; gap:14px}
    @media(min-width:700px){ .choices{ grid-template-columns:1fr 1fr } }
    .choiceBtn{ width:100%; text-align:left; padding:16px 18px; border-radius:16px; border:2px solid var(--border2); background:#fff;
      box-shadow: 0 1px 3px rgba(15,23,42,.06); cursor:pointer;
    }
    .choiceBtn:hover{box-shadow:0 2px 6px rgba(15,23,42,.08)}
    .choiceSmall{font-size:14px; color:#ea580c; font-weight:800}
    .choiceLabel{margin-top:8px; font-size:17px; font-weight:900; color:#c2410c}
    .help{font-size:13px; color:#64748b; margin-top:12px}
    .footer{ text-align:center; color:#94a3b8; font-size:12px; margin-top:8px }
    .lineList{display:grid; gap:12px; margin-top:10px}
    .lineItem{display:flex; align-items:flex-start; gap:10px; justify-content:space-between; border:2px solid var(--border); border-radius:14px; padding:12px 14px; background:#fff; position:relative}
    .lineItem.active{ border-color:#16a34a; box-shadow:0 0 0 2px rgba(16,185,129,.08) inset }
    .lineItem.active::before{ content:""; position:absolute; left:0; top:0; bottom:0; width:6px; border-radius:14px 0 0 14px; background:#16a34a }
    .lineText{flex:1 1 auto; font-size:17px; line-height:2; white-space:pre-wrap; word-break:break-word}
    .lineOps{flex:0 0 auto; display:flex; gap:6px; align-items:center} /* gapç¸®å°è®“æŒ‰éˆ•æ›´é è¿‘å€’æ•¸ */
    .lineCopied{
      min-width:132px; /* å›ºå®šå¯¬é¿å…è·³å‹• */
      text-align:right;
      font-size:17px; /* èˆ‡å·¦å´å­—ä¸€æ¨£å¤§ */
      line-height:2;
      font-weight:900; color:#16a34a;
    }
    .lineCopied:empty{ visibility:hidden } /* æ²’æ–‡å­—æ™‚ä¸ä½”ä½çš„åç™½ */
    .tips{ margin-top:12px; background:#eef2ff; border:2px solid #c7d2fe; color:#3730a3;
      border-radius:16px; padding:18px 20px; font-size:16px; line-height:2 }
    .tips b{font-weight:900}

    /* ===== Tabs (æ›¸ç±¤) ===== */
    .tabs{ display:flex; gap:10px; flex-wrap:wrap; margin-top:8px }
    .tabs-rows{ display:flex; flex-direction:column; gap:12px }
    .tabs-row{ display:flex; align-items:center; gap:14px; flex-wrap:wrap }
    .tab-label{ font-weight:900; color:#334155; background:#e5e7eb; border:1px solid #cbd5e1; padding:8px 12px; border-radius:999px }
    .tab-label.primary{ background:#dcfce7; border-color:#86efac; color:#166534 }
    .tab{
      background:var(--tabBg); color:var(--tabText); border:2px solid var(--tabBorder);
      padding:10px 16px; font-weight:900; border-radius:999px; cursor:pointer; user-select:none;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.03);
      transition:.15s ease;
    }
    .tab:hover{ filter:brightness(0.98) }
    .tab.active{
      background:var(--tabActBg);
      color:var(--tabActText);
      border-color:var(--tabActBorder);
      box-shadow: 0 6px 18px rgba(34,197,94,.18), inset 0 -3px 0 rgba(34,197,94,.2);
    }
    .tab .sub{ font-size:12px; color:#059669; font-weight:800; margin-left:6px }

    /* èªªæ˜ï¼ˆç´…è‰²æ–‡å­—ï¼‰ */
    .explain{
      background:#fff1f2; border:1px dashed #fecaca; color:#b91c1c;
      border-radius:12px; padding:10px 12px; font-size:15px; line-height:1.9; margin:6px 0 4px 0
    }
    .explain b{ color:#b91c1c }

    /* Focus modal styles */
    .modal{ position:fixed; inset:0; display:none; align-items:flex-start; justify-content:center; padding:40px 16px; background:rgba(2,6,23,.55); z-index:50 }
    .modal.show{ display:flex }
    .modalCard{ width: min(860px, 100%); background:#fff; border-radius:20px; border:1px solid #e2e8f0; box-shadow: 0 10px 30px rgba(2,6,23,.35); padding:16px 16px 20px; 
      display:flex; flex-direction:column; max-height:86vh; }
    .modalHead{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:4px 6px 10px }
    .modalTitle{ font-size:19px; font-weight:900; color:#111827 }
    .modalClose{ border:none; background:#f3f4f6; color:#111827; padding:10px 12px; border-radius:10px; font-weight:900; cursor:pointer }
    .modalClose:hover{ background:#e5e7eb }
    .groupTitle{ font-size:18px; font-weight:900; color:#0f172a; margin-top:8px; margin-bottom:8px }
    .groupCard{ border:1px solid #bfdbfe; background:#eff6ff; border-radius:16px; padding:14px; margin-top:12px; box-shadow: inset 0 0 0 1px #dbeafe }
    .announce .lineItem{ border:1px dashed #bfdbfe; background:#ffffff }
    .announce .lineText{ font-size:18px }
    .announce .lineItem + .lineItem{ margin-top:4px }
    .modalBody{ overflow:auto; padding-right:4px }
    #focusModal .modalHead{ background: linear-gradient(90deg, #22c55e, #16a34a); color:#fff; border-radius:14px; margin:-8px -8px 12px; padding:14px 16px }
    #focusModal .modalTitle{ color:#fff; font-size:22px }
    #focusModal .modalClose{ background:#ecfdf5; color:#065f46 }

    /* æ›¸ç±¤åˆ—æ¨™é¡Œï¼ˆç´”æ–‡å­—ç²—é«”ï¼‹å†’è™Ÿï¼‰ */
    .tab-heading{ font-weight:900; color:#0f172a; padding:0; margin-right:6px; }
    .tab-heading.primary{ color:#166534 }
    /* ä¸»è¦/å…¶å®ƒ ä¹‹é–“çš„åˆ†éš”ç·š */
    .tabs-divider{ border:none; border-top:1px solid var(--border2); margin:10px 0; }

    /* çœ‹æƒ…æ³å»¶ä¼¸ï½œå¯ä¸ä¸Ÿï¼ˆæ©˜è‰²æ¡†ï¼‰ */
    .optionalBox{
      margin-top:16px;
      border:2px dashed #fed7aa;
      background:#fff7ed;
      color:#9a3412;
      border-radius:14px;
      padding: 12px 0;
    }
    .optionalTitle{ font-size:15px; font-weight:900; margin-bottom:10px; }
    .optionalBox .lineItem{ border-color:#fed7aa; background:#fff }
    .optionalBox .lineCopied{ color:#d97706 }
  
  /* Hero Title */
  .heroTitle{
    font-size: clamp(28px, 2vw + 20px, 44px);
    line-height: 1.15;
    font-weight: 800;
    letter-spacing: .02em;
    margin: 0;
    background: linear-gradient(90deg, #0ea5e9, #22c55e, #f59e0b);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    filter: drop-shadow(0 1px 0 rgba(0,0,0,.08));
  }
  @supports not (-webkit-background-clip: text) {
    .heroTitle{ color:#0f172a; }
  }

  .actions{ display:flex; align-items:center; gap:10px; flex-wrap:nowrap }

  /* Stronger hover for copy buttons */
  .btn.btn-primary{
    cursor:pointer;
    transition: background .15s ease, border-color .15s ease, box-shadow .15s ease, transform .02s ease;
  }
  .btn.btn-primary:hover{
    background:#059669;
    border-color:#059669;
    box-shadow:0 0 0 3px rgba(16,185,129,.25), 0 6px 12px rgba(16,185,129,.20);
    color:#fff;
  }
  .btn.btn-primary:focus-visible{
    outline:0;
    box-shadow:0 0 0 3px rgba(16,185,129,.35), 0 6px 12px rgba(16,185,129,.25);
  }
  .btn.btn-primary:active{
    transform: translateY(1px);
    background:#047857;
    border-color:#047857;
  }
  .btn.btn-primary:disabled{ cursor:not-allowed; background:#e2e8f0; color:#94a3b8; border-color:#e2e8f0; box-shadow:none; }

  /* å¤§ä¸€é»ã€æ›´é•·çš„è¤‡è£½æŒ‰éˆ• */
  .btn-copy{
    font-size:16px;
    padding:12px 22px;
    min-width:96px;
    border-radius:16px;
  }

  /* Stronger hover/focus for header's green button */
  .btn.btn-green{
    transition: background .15s ease, border-color .15s ease, box-shadow .15s ease, transform .02s ease;
  }
  .btn.btn-green:hover{
    background:#059669;
    border-color:#059669;
    box-shadow:0 0 0 3px rgba(16,185,129,.25), 0 6px 12px rgba(16,185,129,.20);
    color:#ffffff;
  }
  .btn.btn-green:focus-visible{
    outline:0;
    box-shadow:0 0 0 3px rgba(16,185,129,.35), 0 6px 12px rgba(16,185,129,.25);
  }
  .btn.btn-green:active{
    transform: translateY(1px);
    background:#047857;
    border-color:#047857;
  }

  .toast{ position:fixed; left:50%; bottom:22px; transform:translateX(-50%); background:#111827; color:#fff; padding:10px 14px; border-radius:10px; font-weight:900; box-shadow:0 8px 24px rgba(0,0,0,.18); z-index:9999 }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="heroTitle">äººä¹‹æ‰€ä»¥èƒ½ï¼Œæ˜¯å› ç‚ºç›¸ä¿¡è‡ªå·±èƒ½</h1>
      <div class="actions">
        <!-- åªä¿ç•™ã€ŒåŸ¹é¤Šé‡é»ã€ -->
        <button id="btnFocus" class="btn btn-green">åŸ¹é¤Šé‡é»</button>
      </div>
    </div>

    <details class="tips">
      <summary><b>ä½¿ç”¨èªªæ˜</b></summary>
      <div>
        1) å…ˆé€å‡ºé–‹å ´å¥ï¼›<b>é‡åˆ°å®¢äººå›è¦†ï¼Œå°±åœ¨ä¸‹æ–¹é¸æ“‡å°æ‡‰é¸é …</b>ã€‚<br>
        2) <b>æ³¨æ„ç™¼é€æ™‚é–“ä¸è¦å¤ªçŸ­</b>ï¼ˆå»ºè­°ä¾ã€Œå­—æ•¸â†’ç§’æ•¸ã€çš„å€’æ•¸æé†’ï¼‰ã€‚
      </div>
    </details>

    <div class="card" style="margin-top:18px">
      <div class="tabs-rows">
        <div class="tabs-row">
          <span class="tab-heading primary">ä¸»è¦åŠŸèƒ½ï¼ˆå‰›é€²ä¾†ä¸€å®šè¦èŠï¼‰:</span>
          <div class="tabs" id="tabs-primary">
            <div class="tab active" data-tab="t1">æ‰“é–‹å¿ƒæˆ¿ãƒ»é™ç–‘æ…® <span class="sub">ï¼ˆèŠå¤©è©±é¡Œï¼‰</span></div>
          </div>
        </div>
        <hr class="tabs-divider"/>
        <div class="tabs-row">
          <span class="tab-heading">å…¶å®ƒåŠŸèƒ½:</span>
          <div class="tabs" id="tabs-other">
            <div class="tab" data-tab="t2">è®“å®¢äººä¸»å‹•è¦ç…§ç‰‡</div>
            <div class="tab" data-tab="t3">è§£ç‚ºä»€éº¼ç©äº¤å‹è»Ÿé«”</div>
            <div class="tab" data-tab="t4">è§£ IGãƒ»FB</div>
          </div>
        </div>
      </div>
    </div>

    <div id="contentWrap" class="grid theme-msg" style="margin-top:14px">
      <section class="card">
        <div id="headerRow" class="row" style="margin-bottom:10px">
          <div class="sectionTitle">æ‰“é–‹å¿ƒæˆ¿ãƒ»é™ç–‘æ…®</div>
          <div style="display:flex; gap:12px">
            <button id="btnBack" class="btn btn-lg">ä¸Šä¸€æ­¥</button>
            <button id="btnReset" class="btn btn-danger btn-lg">é‡ä¾†</button>
          </div>
        </div>

        <div id="content"></div>

        <div id="hint" class="help">å°æé†’ï¼šå¥å­è¦é€å¥å‚³é€ï¼Œä¸è¦ä¸€æ¬¡å…¨éƒ¨è²¼ä¸Šï¼›çœ‹å°æ–¹ç¯€å¥é©ç•¶é–“éš”ã€‚</div>
      </section>
    </div>

    <div class="footer">Â© æ–°å®¢è¼”åŠ© v2_4_19 by.KID</div>
  </div>

  <!-- å¾ŒçºŒåŸ¹é¤Šé‡é»ï¼ˆå…¬å‘Šå¼ï¼‰ -->
  <div id="focusModal" class="modal" aria-hidden="true">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">å¾ŒçºŒåŸ¹é¤Šé‡é»</div>
        <button class="modalClose" id="focusClose">é—œé–‰</button>
      </div>
      <div id="focusBody" class="modalBody announce"></div>
    </div>
  </div>

  <script>
    // ====== Data ======
    const NODES = {
      intro: { type: "message", title: "é–‹å ´å°è©", lines: ["å°äº† ä½ å¾ˆå¸¸åœ¨ç¶²è·¯ä¸Šè·ŸäººèŠå¤©å—?"], next: "habitChoice" },
      habitChoice: {
        type: "choice", title: "å®¢äººå›è¦†æ˜¯å“ªä¸€ç¨®?",
        options: [
          { id: "many", label: "å®¢äººå›ï¼šè »å¸¸çš„ï¼å¾ˆå¤š", next: "reply_many" },
          { id: "few", label: "å®¢äººå›ï¼šå¾ˆå°‘ï¼æ²’æœ‰", next: "reply_few" },
        ],
      },
      reply_many: { type: "message", title: "å›è¦†çµ¦å®¢äºº", lines: ["æˆ‘æ˜¯è »å°‘çš„","é‚£ä½ æœ‰é‡éä»€éº¼å¥‡æ€ªçš„äººå—?"], next: "weirdChoice" },
      reply_few:  { type: "message", title: "å›è¦†çµ¦å®¢äºº", lines: ["æˆ‘ä¹Ÿæ˜¯è »å°‘çš„","é‚£ä½ æœ‰é‡éä»€éº¼å¥‡æ€ªçš„äººå—?"], next: "weirdChoice" },
      weirdChoice: {
        type: "choice", title: "å®¢äººå°ã€å¥‡æ€ªçš„äººã€çš„å›è¦†?",
        options: [
          { id: "no", label: "å®¢äººå›ï¼šæ²’æœ‰", next: "reply_no_weird" },
          { id: "yesScam", label: "å®¢äººå›ï¼šæœ‰ ä¾‹å¦‚æ¨éŠ·/æŠ•è³‡/è©é¨™", next: "reply_yes_scams" },
        ],
      },
      reply_no_weird: {
        type: "message", title: "å›è¦†çµ¦å®¢äºº",
        lines: [
          "æˆ‘é‡éå¾ˆå¤šæ˜æ˜é‚„ä¸ç†Ÿ å°±ä¸€ç›´æ‰“é›»è©± ä¸ç„¶å°±æ˜¯ä¸€ç›´è¦ç´„å‡ºå»...",
          "æˆ–æ˜¯ä¸€ç›´èªªè¦ä¾†æ‰¾æˆ‘..",
          "æ„Ÿè¦ºå°±æ˜¯åœ¨äº‚æ§æ‰“é³¥ğŸ™„",
          "æ‰€ä»¥å¾Œä¾†æˆ‘å°±å¾ˆå°‘åœ¨ç¶²è·¯ä¸Šèªè­˜äºº",
        ], next: null,
      },
      reply_yes_scams: {
        type: "message", title: "å›è¦†çµ¦å®¢äºº",
        lines: [
          "æˆ‘ä¹Ÿæœ‰é‡éè©é¨™ é‚„æœ‰å¾ˆå¤šæ˜æ˜é‚„ä¸ç†Ÿå°±ä¸€ç›´æ‰“é›»è©±",
          "ä¸ç„¶å°±æ˜¯ä¸€ç›´è¦ä¾†æ‰¾æˆ‘ ç´„å‡ºå»çš„..",
          "æ„Ÿè¦ºå°±æ˜¯åœ¨äº‚æ§æ‰“é³¥ğŸ™„",
          "æ‰€ä»¥å¾Œä¾†æˆ‘å°±å¾ˆå°‘åœ¨ç¶²è·¯ä¸Šèªè­˜äºº",
        ],
        optionalLines: [
          "æœ€æ‰¯çš„æ˜¯é‚„æœ‰é‡éç®—å‘½çš„ ä»–æœƒå…è²»å¹«ä½ ç®—",
          "ç„¶å¾Œèªªä½ å“ªè£¡å“ªè£¡ä¸å¥½ å¯ä»¥å¹«ä½ æ”¹é‹ å«ä½ è²·è½‰é‹é¦™æ°´ æˆ–æ˜¯æ‰‹éˆ é …éŠä¹‹é¡çš„ ä¸€æ¢å°±è¦2.3åƒ...",
          "æˆ‘æœ¬ä¾†æƒ³èªª å¦‚æœå¹¾ç™¾å¡Šå¯ä»¥è²·çœ‹çœ‹",
          "ä½†æ˜¯é€™éº¼è²´ æ„Ÿè¦ºå°±æ˜¯å‡çš„..",
        ],
        next: null,
      },
    };

    // whyï¼ˆç§»é™¤ emojiã€ç¬¬äºŒå¥æ”¶å°¾åŠ çœç•¥è™Ÿï¼‰
    const WHY_LINES = [
      "æˆ‘æ˜¯å› ç‚ºçœ‹åˆ°å»£å‘Šç„¡èŠæ‰æƒ³èªªä¸‹è¼‰çœ‹çœ‹",
      "ä¸Šæ¬¡ç©æ‡‰è©²ä¸€å¹´å¤šå‰äº†å§ å¤ªå¤šæ€ªæ€ªçš„äººäº†...",
    ];

    // photoï¼ˆæ–‡å­—ç´°ä¿®ï¼‰
    const PHOTO_LINES = [
      { text: "æˆ‘å‰›å‰›è¶…ä¸Ÿè‡‰...", explainAfter: "èªªæ˜ï¼šé€™å¥ä¸Ÿå‡ºå»ç­‰å®¢äººå›è¦†ï¼›æ²’æ„å¤–å°æ–¹æœƒå›ã€Œæ€éº¼äº†ï¼ç™¼ç”Ÿä»€éº¼äº‹ï¼ç‚ºä»€éº¼ä¸Ÿè‡‰ï¼Ÿã€" },
      { text: "æˆ‘å‰›å‰›å»è²·å’–å•¡ æˆ‘è½åˆ°åº—å“¡èªªç¾å¥³ä½ çš„å¥½å›‰" },
      { text: "æˆ‘å°±èµ°éå»è¦æ‹¿ çµæœä»–èªªä¸æ˜¯åœ¨å«æˆ‘" },
      { text: "å¥½ä¸Ÿè‡‰..." },
      { text: "æˆ‘æ˜¯æ²’æœ‰åˆ°å¾ˆæ­£ ä½†æ‡‰è©²é‚„ç®—æ¼‚äº®å§..", explainAfter: "èªªæ˜ï¼šç­‰å®¢äººå›ï¼›é€šå¸¸æœƒå•ã€Œä½ é•·æ€æ¨£æˆ‘çœ‹çœ‹ã€â†’ é€™æ™‚å†ä¸Ÿç…§ç‰‡ã€‚è‹¥å°æ–¹æ²’å•ï¼Œå°±ä¸ç”¨ä¸»å‹•ä¸Ÿã€‚" },
    ];

    // ig/fb
    const IG_LINES = [
      { text: "ä¹‹å‰æœ‰ç”¨ ä½†æ˜¯å› ç‚ºæˆ‘å‰ç”·å‹çš„é—œä¿‚" },
      { text: "å¾Œä¾†å°±åˆªæ‰æ²’å†ç”¨äº†", explainAfter: "èªªæ˜ï¼šè¬›å®Œä¸Šé¢ï¼Œå¦‚æœå®¢äººå†è¿½å•ã€Œç‚ºä»€éº¼ã€ï¼Œå†å¾€ä¸‹ä¸Ÿä¸‹ä¸€æ®µã€‚" },
      { text: "æˆ‘æƒ³æƒ³è©²æ€éº¼è·Ÿä½ èªªæ‰å¥½", explainAfter: "èªªæ˜ï¼šå…ˆç­‰ç­‰ç´„ 5 åˆ†é˜å†é–‹å§‹ä¸Ÿä¸‹ä¸€å¥ï¼›æ¯æ®µè‡³å°‘é–“éš” 3â€“5 åˆ†é˜ä»¥ä¸Šï¼Œä¾è¨Šæ¯é•·åº¦è‡ªè¡ŒæŠ“æ™‚é–“ã€‚" },
      { text: "å°±æ˜¯æˆ‘è·Ÿå‰ä»»ä¹Ÿæ˜¯ç¶²è·¯ä¸Šèªè­˜çš„..å‰›é–‹å§‹èŠå¤©æ„Ÿè¦ºé‚„ä¸éŒ¯ ä¹‹å¾Œä¹Ÿå¸¸èŠå¤© è¦‹é¢åƒé£¯  éä¸€æ®µæ™‚é–“ä»–å°±è·Ÿæˆ‘å‘Šç™½ é‚£æ™‚å€™è¦ºå¾—ä»–äººé‚„ä¸éŒ¯ æ‰€ä»¥å°±åœ¨ä¸€èµ·äº†" },
      { text: "å‰›åœ¨ä¸€èµ·çš„æ™‚å€™ä»–å¾ˆè²¼å¿ƒ æ¯å¤©éƒ½æœƒé€é£¯çµ¦æˆ‘åƒ é‚„æœ‰æ¥æˆ‘ä¸Šä¸‹ç­ æˆ‘æœ¬ä¾†ä»¥ç‚ºæœƒä¸€ç›´é€™æ¨£ä¸‹å» çµæœå¥½åƒæ˜¯æˆ‘æƒ³å¤ªå¤š... ä»–æ¯”æˆ‘æƒ³åƒæ›´å®¹æ˜“ç”Ÿæ°£.. ä¸€é–‹å§‹ä»¥ç‚ºä»–åªæ˜¯è¬›è©±æ¯”è¼ƒå¤§è² åˆ°å¾Œé¢è¶Šä¾†è¶Šèª‡å¼µ å‹•æ‰‹è…³é‚„æ‘”æ±è¥¿.. æœ‰ä¸€æ¬¡ç”šè‡³é‚„æŠŠæˆ‘æ¨å€’.. æˆ‘ç¬¬ä¸€æ¬¡æœ‰é‚£ç¨®åš‡åˆ°ä¸æ•¢èªªè©±ä¸æ•¢å‹•çš„æ„Ÿè¦º.. é‚£æ™‚å€™è¶…æ€•ä»–æœƒåšå‡ºæ›´èª‡å¼µçš„äº‹...." },
      { text: "å¾Œä¾†æˆ‘å¯¦åœ¨å—ä¸äº†å°±è·Ÿä»–åˆ†æ‰‹.. ä¸»è¦çš„åŸå› é‚„æ˜¯ä»–è¢«æˆ‘ç™¼ç¾åŠˆè…¿... æˆ‘çœŸçš„æ˜¯æ²’è¾¦æ³•æ¥å— åŸæœ¬æƒ³èªªåˆ†æ‰‹å°±è§£è„«äº† çµæœä»–å±…ç„¶ä¸€ç›´å°æˆ‘æ­»çºçˆ›æ‰“..æˆ‘ä¸æ¥é›»è©±å°±ç›´æ¥ç™»æˆ‘FBé‚„æœ‰IG é‚„è·‘åˆ°æˆ‘ä¸Šç­çš„åœ°æ–¹è·Ÿæˆ‘å®¶å µæˆ‘...é‚„é¨·æ“¾æˆ‘çš„å®¶äººè·Ÿæœ‹å‹ å°±ç®—æ›äº†å¯†ç¢¼å°é–ä¹Ÿæ²’ç”¨ å› ç‚ºæœ‰å…±åŒå¥½å‹..çœŸçš„è¦ºå¾—å¾ˆææ€–..." },
      { text: "é‚£é™£å­å£“åŠ›çœŸçš„å¾ˆå¤§... ç”šè‡³é‚„è¦åƒè—¥æ‰ç¡å¾—è‘—.." },
      { text: "å¾Œä¾†æˆ‘å®¶äººå› ç‚ºæ“”å¿ƒæˆ‘å°±å«æˆ‘æŠŠFBè·ŸIGéƒ½åˆªäº†.. ä¹Ÿå«æˆ‘æŠŠé›»è©±è™Ÿç¢¼æ›äº†.. é‚£æ¬¡æˆ‘çœŸçš„è¢«åš‡åˆ°...ä¹Ÿæ˜¯å¾é‚£ä¹‹å¾Œæˆ‘å°±ä¸å¤ªç›¸ä¿¡æ„Ÿæƒ….." },
      { text: "åˆ°ç¾åœ¨æˆ‘é‚„æ˜¯è¦ºå¾—æˆ‘ç‚ºä»€éº¼æœƒé‡åˆ°é€™ç¨®äº‹..æ˜æ˜åªæ˜¯æƒ³å¥½å¥½çš„ç”Ÿæ´».. å¥½å¥½è«‡æˆ€æ„›.." }
    ];

    // ====== Focus groups ======
    const FOCUS_GROUPS = [
      { title: "é‡é»1ï½œèŠå¤©çš„è³ªæ„Ÿ", lines: [
        { text: "çœŸçš„æŠŠå°æ–¹ç•¶æˆæœ‹å‹ é–‹å¿ƒæ„‰å¿«èŠå¤©", tag: "must" },
        { text: "ä¸è¦æ¯å¤©å°±åªæœ‰ èµ·åºŠ ä¸Šç­ åƒé£¯ ç¡è¦º è¿½åŠ‡", tag: "avoid" },
        { text: "å¦‚æœä½ éƒ½åªæœ‰èŠé€™äº› æœ€å¾Œå®¢äººä¸€å®šè·Ÿä½ ä¸ç†Ÿ ä¸æœƒè²·å–®", tag: "avoid" },
        { text: "å›ç­”å®Œå®¢äººçš„è©±æˆ–å ±å‚™å®Œ è¦é †æ‰‹ä¸Ÿå€‹å•é¡Œçµ¦å®¢äºº", tag: "must" },
      ]},
      { title: "é‡é»2ï½œåˆæœŸäº’ç›¸äº†è§£ï¼ˆä¸æ˜¯èº«å®¶èª¿æŸ¥ï¼‰", lines: [
        { text: "å‰›é–‹å§‹è¦çŸ¥é“å°æ–¹çš„å¹´ç´€ã€è·æ¥­ã€ä½å“ªè£¡ï¼ˆä½†ä¸è¦æŸ¥æˆ¶å£å¼å•æ³•ï¼‰", tag: "tip" },
        { text: "å¥—å¹´ç´€ä½ å¯ä»¥èªªï¼šçœ‹ä½ å¤§é ­è²¼ å¥½åƒè·Ÿæˆ‘å·®ä¸å¤šå¤§ ä½ å¹¾æ­²å‘€", tag: "tip" },
        { text: "å¥—å·¥ä½œä½ å¯ä»¥èªªï¼šå°äº†ä½ ä¸‹ç­äº†å—?", tag: "tip" },
        { text: "å¦‚æœä¸‹ç­äº†ï¼šæ€éº¼é€™éº¼å¥½ é€™éº¼æ—©å°±ä¸‹ç­äº† ä½ æ˜¯åšä»€éº¼çš„ã„š", tag: "tip" },
        { text: "å¦‚æœæ²’ä¸‹ç­ï¼šæ€éº¼é€™éº¼å¥½ ä¸Šç­é‚„å¯ä»¥ç©æ‰‹æ©Ÿ ä½ æ˜¯åšä»€éº¼çš„ã„š", tag: "tip" },
        { text: "å¥—ä½å“ªè£¡ï¼šå°äº†ä½ ä¹Ÿæ˜¯å°åŒ—äººå—?", tag: "tip" },
      ]},
      { title: "ä¸€äº›ç¯„æœ¬", lines: [
        { text: "å°äº†ä½ ä¹Ÿæ˜¯å°åŒ—äººå˜›ï¼ˆè¡ç”Ÿåœ°å€æˆ–åœ¨åœ°ç¾é£Ÿï¼‰", tag: "tip" },
        { text: "èŠé ­åƒä¸»é ï¼ˆè¡ä¼¸èŠèˆˆè¶£ åƒæ˜¯å–œæ­¡å‡ºå»ç© é¢¨æ™¯/å¯µç‰©ç…§åŒç†ï¼‰", tag: "tip" },
        { text: "ä»Šå¤©ä¼‘å‡å—é‚„æ˜¯ä¸Šç­ï¼ˆè¡ç”Ÿä»€éº¼å·¥ä½œï¼‰", tag: "tip" },
        { text: "æˆ‘ç­‰ç­‰å»æ•™èª²äº†ï¼æˆ‘å…ˆæ•™èª²å»æ™šé»èŠï¼æº–å‚™æ˜å¤©çš„ä¸Šèª²çš„æ±è¥¿æ™šé»èŠï¼ˆè®“å®¢äººä¸»å‹•å•æˆ‘å€‘å·¥ä½œï¼‰", tag: "tip" },
        { text: "é‚£ä½ æ˜¯ä»€éº¼å·¥ä½œçš„å‘€ï¼ˆè¡ç”Ÿå·¥ä½œå…§å®¹ï¼‰", tag: "tip" },
      ]},
    ];

    // ====== State ======
    let activeTab = "t1";
    let nodeId = "intro";
    let history = ["intro"];
    let lastCopiedKeys = new Set();
    let lastCopiedWhySet = new Set();
    let lastCopiedPhotoSet = new Set();
    let lastCopiedIGSet = new Set();

    const contentEl = document.getElementById("content");
    const btnBack = document.getElementById("btnBack");
    const btnReset = document.getElementById("btnReset");
    const headerRow = document.getElementById("headerRow");
    const hint = document.getElementById("hint");

    // ====== å€’æ•¸ç‹€æ…‹ï¼ˆ0.1ç§’æ›´æ–°ï¼Œé¡¯ç¤ºåˆ°å°æ•¸ç¬¬ä¸€ä½ï¼‰ ======
    const countdowns = {}; // key -> å‰©é¤˜ç§’æ•¸ï¼ˆfloatï¼‰
    let tickTimer = null;
    const TICK_MS = 100;
    const TICK_STEP = 0.1;

    function ensureTick(){
      if(tickTimer) return;
      tickTimer = setInterval(()=>{
        const keys = Object.keys(countdowns);
        keys.forEach(k=>{
          if(countdowns[k]>0){
            // æ¸›å°‘0.1ç§’ï¼Œä¸¦é¿å…æµ®é»èª¤å·®
            const next = Math.max(0, Math.round((countdowns[k]-TICK_STEP)*10)/10);
            countdowns[k] = next;
          }
        });
        updateCountdownDisplays();
        if(Object.values(countdowns).every(v=>!v||v<=0)){
          clearInterval(tickTimer); tickTimer=null;
        }
      }, TICK_MS);
    }

    function updateCountdownDisplays(){
      document.querySelectorAll('.lineCopied[data-key]').forEach(el=>{
        const k = el.dataset.key;
        const n = Number(countdowns[k]||0);
        if(n>0){
          el.textContent = `å€’æ•¸ ${n.toFixed(1)} ç§’`; el.style.color='#16a34a';
        }else if(el.closest('.lineItem')?.classList.contains('active')){
          el.textContent = 'å¯é€'; el.style.color='#16a34a';
        }else{
          el.textContent = '';
        }
      });
    }

    // ====== Tabs ======
    document.getElementById('tabs-primary')?.setAttribute('role','tablist');
    document.getElementById('tabs-other')?.setAttribute('role','tablist');

    function clearOtherTabState(tabId){
      // åªé‡å°ã€Œå…¶å®ƒåŠŸèƒ½ã€è‡ªå‹•é‡è£½ï¼šæ¸…æ‰è©²åˆ†é çš„ã€Œå·²è¤‡è£½ç‹€æ…‹ã€èˆ‡å€’æ•¸
      if(tabId==='t2'){ lastCopiedPhotoSet = new Set(); }
      if(tabId==='t3'){ lastCopiedWhySet = new Set(); }
      if(tabId==='t4'){ lastCopiedIGSet = new Set(); }
      Object.keys(countdowns).forEach(k=>{ if(k.startsWith(tabId+'-')) delete countdowns[k]; });
      if(Object.values(countdowns).every(v=>!v||v<=0) && tickTimer){ clearInterval(tickTimer); tickTimer=null; }
    }

    document.querySelectorAll(".tab").forEach(t=>{
      t.setAttribute("role","tab");
      t.setAttribute("tabindex","0");
      t.setAttribute("aria-selected", t.dataset.tab===activeTab ? "true" : "false");
      t.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); t.click(); } });
      t.addEventListener("click", ()=>{
        // åˆ‡æ›åˆ†é å‰ï¼šå¦‚æœé›¢é–‹çš„æ˜¯ã€Œå…¶å®ƒåŠŸèƒ½ã€ï¼Œè‡ªå‹•é‡è£½
        if(activeTab !== t.dataset.tab){
          if(activeTab==='t2'||activeTab==='t3'||activeTab==='t4'){ clearOtherTabState(activeTab); }
        }
        document.querySelectorAll(".tab").forEach(x=>{ x.classList.remove("active"); x.setAttribute("aria-selected","false"); });
        t.classList.add("active"); t.setAttribute("aria-selected","true");
        activeTab = t.dataset.tab;
        if(activeTab === "t1"){ headerRow.style.display = "flex"; hint.style.display="block"; }
        else { headerRow.style.display = "none"; hint.style.display="none"; }
        render();
      });
    });

    function copyToClipboard(text){
      if (navigator.clipboard && navigator.clipboard.writeText) {
        return navigator.clipboard.writeText(text).then(()=>true).catch(()=>false);
      }
      const ta = document.createElement('textarea');
      ta.value = text; ta.style.position='fixed'; ta.style.opacity='0';
      document.body.appendChild(ta); ta.focus(); ta.select();
      let ok=false; try{ ok=document.execCommand('copy'); }catch(e){ ok=false; }
      document.body.removeChild(ta);
      return Promise.resolve(ok);
    }
    function toast(msg, ms=1800){ const t = document.createElement('div'); t.className='toast'; t.textContent=msg; document.body.appendChild(t); setTimeout(()=>t.remove(), ms); }

    function round10(n){ return Math.round(n/10)*10; }
    function recommendSecondsFromText(s){
      const len = (s||'').replace(/\\s/g,'').length; // ä¾å­—æ•¸
      const sec = round10(len);
      return Math.max(10, sec); // è‡³å°‘10ç§’
    }

    function markCopiedAndCountdown(key, text){
      const sec = recommendSecondsFromText(text);
      countdowns[key] = sec;
      toast(`å·²è¤‡è£½ï¼šå»ºè­° ${sec.toFixed(1)} ç§’å¾Œå†é€å‡º`);
      ensureTick();
      updateCountdownDisplays();
    }

    function renderLines(listEl, arr, tracker){
      listEl.innerHTML = "";
      arr.forEach((obj, idx) => {
        const key = `${activeTab}-${idx}`; // å…¶å®ƒåŠŸèƒ½ç”¨ tab+index
        const isCopied = (tracker && typeof tracker.has === "function") ? tracker.has(idx) : false;
        const item = document.createElement("div"); item.className = "lineItem" + (isCopied ? " active" : "");
        const text = document.createElement("div"); text.className = "lineText"; text.textContent = obj.text || obj;
        const ops = document.createElement("div"); ops.className = "lineOps";
        const btn = document.createElement("button"); btn.className = "btn btn-primary btn-copy"; btn.textContent = "è¤‡è£½";
        const state = document.createElement("div"); state.className = "lineCopied"; state.dataset.key = key; state.textContent = (isCopied ? (countdowns[key]>0?`å€’æ•¸ ${Number(countdowns[key]).toFixed(1)} ç§’`:'å¯é€') : "");
        btn.addEventListener("click", async () => {
          const content = obj.text || obj;
          const ok = await copyToClipboard(content);
          if(!ok){ alert("è¤‡è£½å¤±æ•—ï¼šç€è¦½å™¨é™åˆ¶ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½"); return; }
          if (tracker && typeof tracker.add === "function") tracker.add(idx);
          item.classList.add('active');
          markCopiedAndCountdown(key, content);
        });
        ops.appendChild(btn); ops.appendChild(state);
        item.appendChild(text); item.appendChild(ops); listEl.appendChild(item);
        if(obj.explainAfter){ const exp = document.createElement("div"); exp.className = "explain"; exp.innerHTML = obj.explainAfter; listEl.appendChild(exp); }
      });
    }

    function render(){
      contentEl.innerHTML = "";

      if(activeTab === "t1"){
        const node = NODES[nodeId];
        const cardTitle = document.createElement("div"); cardTitle.className = "sectionTitle"; cardTitle.textContent = node.title; contentEl.appendChild(cardTitle);

        if(node.type === "message"){
          const lines = node.lines || [];
          const list = document.createElement("div"); list.className = "lineList";
          lines.forEach((line, idx) => {
            const key = `${nodeId}-${idx}`;
            const item = document.createElement("div"); item.className = "lineItem" + (lastCopiedKeys.has(key) ? " active" : "");
            const text = document.createElement("div"); text.className = "lineText"; text.textContent = line;
            const ops = document.createElement("div"); ops.className = "lineOps";
            const btn = document.createElement("button"); btn.className = "btn btn-primary btn-copy"; btn.textContent = "è¤‡è£½";
            const copied = document.createElement("div"); copied.className = "lineCopied"; copied.dataset.key = key; copied.textContent = (lastCopiedKeys.has(key) ? (countdowns[key]>0?`å€’æ•¸ ${Number(countdowns[key]).toFixed(1)} ç§’`:'å¯é€') : "");
            btn.addEventListener("click", async () => {
              const ok = await copyToClipboard(line);
              if(!ok){ alert("è¤‡è£½å¤±æ•—ï¼šç€è¦½å™¨é™åˆ¶ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½"); return; }
              lastCopiedKeys.add(key);
              item.classList.add('active');
              markCopiedAndCountdown(key, line);
            });
            ops.appendChild(btn); ops.appendChild(copied);
            item.appendChild(text); item.appendChild(ops); list.appendChild(item);
          });
          contentEl.appendChild(list);

          if(node.optionalLines && node.optionalLines.length){
            const opt = document.createElement("div"); opt.className = "optionalBox";
            const ot = document.createElement("div"); ot.className = "optionalTitle"; ot.textContent = "çœ‹æƒ…æ³å»¶ä¼¸ï½œå¯ä¸ä¸Ÿ";
            const olist = document.createElement("div"); olist.className = "lineList";
            node.optionalLines.forEach((line, idx) => {
              const key = `${nodeId}-opt-${idx}`;
              const item = document.createElement("div"); item.className = "lineItem" + (lastCopiedKeys.has(key) ? " active" : "");
              const text = document.createElement("div"); text.className = "lineText"; text.textContent = line;
              const ops = document.createElement("div"); ops.className = "lineOps";
              const btn = document.createElement("button"); btn.className = "btn btn-primary btn-copy"; btn.textContent = "è¤‡è£½";
              const copied = document.createElement("div"); copied.className = "lineCopied"; copied.dataset.key = key; copied.textContent = (lastCopiedKeys.has(key) ? (countdowns[key]>0?`å€’æ•¸ ${Number(countdowns[key]).toFixed(1)} ç§’`:'å¯é€') : "");
              btn.addEventListener("click", async () => {
                const ok = await copyToClipboard(line);
                if(!ok){ alert("è¤‡è£½å¤±æ•—ï¼šç€è¦½å™¨é™åˆ¶ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½"); return; }
                lastCopiedKeys.add(key);
                item.classList.add('active');
                markCopiedAndCountdown(key, line);
              });
              ops.appendChild(btn); ops.appendChild(copied);
              item.appendChild(text); item.appendChild(ops); olist.appendChild(item);
            });
            opt.appendChild(ot); opt.appendChild(olist); contentEl.appendChild(opt);
          }

          if(node.next){
            const nextRow = document.createElement("div"); nextRow.style.marginTop = "16px";
            const btnNext = document.createElement("button"); btnNext.className = "btn btn-primary btn-next"; btnNext.textContent = "å‰å¾€ä¸‹ä¸€æ­¥ï¼ˆå®¢äººå›è¦† â†’ é¸æ“‡ï¼‰";
            btnNext.addEventListener("click", () => { nodeId = node.next; history.push(node.next); render(); });
            nextRow.appendChild(btnNext); contentEl.appendChild(nextRow);
          }
        }

        if(node.type === "choice"){
          const wrap = document.createElement("div"); wrap.className = "choiceWrap"; const grid = document.createElement("div"); grid.className = "choices";
          node.options.forEach((opt, idx) => {
            const btn = document.createElement("button"); btn.className = "choiceBtn";
            const small = document.createElement("div"); small.className = "choiceSmall"; small.textContent = "é¸é … " + (idx+1);
            const label = document.createElement("div"); label.className = "choiceLabel"; label.textContent = opt.label;
            btn.appendChild(small); btn.appendChild(label);
            btn.addEventListener("click", () => { nodeId = opt.next; history.push(opt.next); render(); });
            grid.appendChild(btn);
          });
          wrap.appendChild(grid); contentEl.appendChild(wrap);
        }
      }
      else if(activeTab === "t2"){
        const t = document.createElement("div"); t.className="sectionTitle"; t.textContent = "è®“å®¢äººä¸»å‹•è¦ç…§ç‰‡ï¼ˆå«èªªæ˜ï¼‰"; contentEl.appendChild(t);
        const list = document.createElement("div"); list.className="lineList"; contentEl.appendChild(list);
        renderLines(list, PHOTO_LINES, lastCopiedPhotoSet);
      }
      else if(activeTab === "t3"){
        const t = document.createElement("div"); t.className="sectionTitle"; t.textContent = "ç‚ºä»€éº¼ç©äº¤å‹è»Ÿé«”ï¼ˆåˆ†å¥è¤‡è£½ï¼‰"; contentEl.appendChild(t);
        const list = document.createElement("div"); list.className="lineList"; contentEl.appendChild(list);
        renderLines(list, WHY_LINES.map(x=>({text:x})), lastCopiedWhySet);
      }
      else if(activeTab === "t4"){
        const t = document.createElement("div"); t.className="sectionTitle"; t.textContent = "è§£ IGãƒ»FBï¼ˆå«èªªæ˜ï¼‰"; contentEl.appendChild(t);
        const list = document.createElement("div"); list.className="lineList"; contentEl.appendChild(list);
        renderLines(list, IG_LINES, lastCopiedIGSet);
      }

      updateCountdownDisplays();
    }

    // ====== Focus modal (å…¬å‘Š) ======
    const focusModal = document.getElementById("focusModal");
    function pill(tag){ return tag === "must" ? "å¿…åš" : tag === "avoid" ? "é¿å…" : "æŠ€å·§"; }
    function renderFocus(){
      const body = document.getElementById("focusBody");
      body.innerHTML = "";
      const groups = FOCUS_GROUPS;
      groups.forEach((grp) => {
        const shell = document.createElement("div"); shell.className = "groupCard";
        const title = document.createElement("div"); title.className = "groupTitle"; title.textContent = grp.title;
        const list = document.createElement("div"); list.className = "lineList";
        grp.lines.forEach((it)=>{
          const item = document.createElement("div"); item.className = "lineItem";
          const text = document.createElement("div"); text.className = "lineText";
          const msg = document.createElement("span"); msg.textContent = it.text;
          const tag = document.createElement("span"); tag.textContent = pill(it.tag); tag.style.cssText="display:inline-block;font-weight:900;margin-right:8px;padding:4px 9px;border-radius:999px;border:1px solid #c7d2fe;background:#e0e7ff;color:#3730a3";
          if(it.tag==='must'){ tag.style.background='#dcfce7'; tag.style.color='#166534'; tag.style.borderColor='#86efac'; }
          if(it.tag==='avoid'){ tag.style.background='#fee2e2'; tag.style.color='#991b1b'; tag.style.borderColor='#fecaca'; }
          text.appendChild(tag); text.appendChild(msg);
          item.appendChild(text);
          list.appendChild(item);
        });
        shell.appendChild(title); shell.appendChild(list); body.appendChild(shell);
      });
    }
    function openFocus(){ renderFocus(); focusModal.classList.add("show"); focusModal.setAttribute("aria-hidden","false"); const closeBtn = document.getElementById("focusClose"); if(closeBtn) closeBtn.focus(); }
    function closeFocus(){ focusModal.classList.remove("show"); focusModal.setAttribute("aria-hidden","true"); }
    document.getElementById("btnFocus").addEventListener("click", openFocus);
    document.getElementById("focusClose").addEventListener("click", closeFocus);
    focusModal.addEventListener("click",(e)=>{ if(e.target===focusModal) closeFocus(); });
    window.addEventListener("keydown",(e)=>{ if(e.key==="Escape") closeFocus(); });

    // ====== ä¸»è¦åŠŸèƒ½ï¼šä¸Šä¸€æ­¥ & é‡ä¾† ======
    function resetPrimary(){
      nodeId = "intro";
      history = ["intro"];
      // æ¸…æ‰ä¸»è¦æµç¨‹ç›¸é—œçš„å€’æ•¸ï¼ˆä¿å®ˆä½œæ³•ï¼šå…¨éƒ¨æ¸…ç©ºï¼‰
      Object.keys(countdowns).forEach(k=>{ delete countdowns[k]; });
      if(tickTimer){ clearInterval(tickTimer); tickTimer=null; }
      lastCopiedKeys = new Set();
      render();
    }
    btnReset.addEventListener("click", resetPrimary);
    btnBack.addEventListener("click", ()=>{
      if(history.length>1){
        history.pop();
        nodeId = history[history.length-1];
        render();
      }
    });

    // Init
    render();
  </script>
</body>
</html>
